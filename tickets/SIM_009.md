# SIM-009: Curriculum UI ("The Path")

## üéØ OBJECTIVE
Build the Curriculum screen ‚Äî a dedicated learning experience where users progress through 20 biological lessons organized by mastery level. This is "the other heart of the app" alongside Home.

## üë§ USER STORY
**As a** user who wants to understand *why* these habits work,
**I want** a structured path through educational content,
**So that** I build lasting knowledge, not just follow instructions blindly.

---

## üß≠ NAVIGATION RESTRUCTURE

### Current State
```
Home | Log | Learn | Profile (4 tabs)
```

### New State
```
Home | Learn | Profile (3 tabs)
```

### Rationale
- **Log tab is redundant** ‚Äî Plate Checks are triggered from Home via NourishmentCard
- **3 tabs** positions Learn as the **true center**
- Simpler navigation = cleaner mental model
- Future logging history can live in Profile ‚Üí "My Logs"

### Tasks
1. Remove `app/(tabs)/log.tsx`
2. Update `app/(tabs)/_layout.tsx` to remove Log tab
3. Reorder: Home (left), Learn (center), Profile (right)

---

## ‚úÖ ACCEPTANCE CRITERIA

### Part 1: Distinctive Center Tab Icon

**Goal:** The Learn tab should visually stand out as special.

**Design:**
- **Icon:** Custom brain/pathway icon OR styled üß† emoji with effects
- **Progress Ring:** Circular progress indicator around the icon
  - Shows % of curriculum completed (e.g., 3/20 = 15%)
  - Animated fill on progress changes
- **Active State:** Subtle glow effect (orange radial gradient behind icon)
- **Platform Effect:** Optional slight elevation/shadow

**Implementation:**
```typescript
// Custom TabIcon for Learn tab
function LearnTabIcon({ focused, progress }: { focused: boolean; progress: number }) {
  // progress = 0-1 (percentage complete)
  return (
    <View style={styles.learnIconContainer}>
      {/* Progress ring (SVG or react-native-svg) */}
      <Svg width={36} height={36}>
        <Circle cx={18} cy={18} r={16} stroke="#e7e5e4" strokeWidth={2} fill="none" />
        <Circle 
          cx={18} cy={18} r={16} 
          stroke="#f97316" strokeWidth={2} fill="none"
          strokeDasharray={`${progress * 100} 100`}
          rotation={-90} origin="18, 18"
        />
      </Svg>
      {/* Icon centered */}
      <Text style={styles.learnIcon}>üß†</Text>
      {/* Glow effect when focused */}
      {focused && <View style={styles.learnGlow} />}
    </View>
  );
}
```

---

### Part 2: Curriculum Screen Layout

**Screen Structure:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ [Safe Area Top]                      ‚îÇ
‚îÇ                                      ‚îÇ
‚îÇ         ‚óê 15% Complete               ‚îÇ  ‚Üê Large progress arc
‚îÇ           3 of 20                    ‚îÇ
‚îÇ                                      ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ   ‚îÇ
‚îÇ                                      ‚îÇ
‚îÇ  üå± FOUNDATION                       ‚îÇ  ‚Üê Section header
‚îÇ  The fundamentals of energy & food   ‚îÇ
‚îÇ                                      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ ‚úì  Energy Balance              ‚îÇ  ‚îÇ  ‚Üê Completed lesson
‚îÇ  ‚îÇ     The First Law...           ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ ‚úì  Protein Leverage            ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ     Why Protein Fills You Up   ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ ‚Üí  The Thermic Effect          ‚îÇ  ‚îÇ  ‚Üê Current (highlighted)
‚îÇ  ‚îÇ     Calories That Cost...      ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ ‚óã  Volume Eating               ‚îÇ  ‚îÇ  ‚Üê Locked (dimmed)
‚îÇ  ‚îÇ     Eat More, Weigh Less       ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ                                      ‚îÇ
‚îÇ  üåø INTERMEDIATE                     ‚îÇ
‚îÇ  Complete Foundation to unlock       ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ üîí Hyper-Palatability          ‚îÇ  ‚îÇ  ‚Üê Locked section
‚îÇ  ‚îÇ üîí The Whoosh Effect           ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ...                            ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ                                      ‚îÇ
‚îÇ  üå≥ ADVANCED                         ‚îÇ
‚îÇ  Complete Intermediate to unlock     ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
‚îÇ  ‚îÇ üîí Adaptive Thermogenesis      ‚îÇ  ‚îÇ
‚îÇ  ‚îÇ ...                            ‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
‚îÇ                                      ‚îÇ
‚îÇ [Tab Bar]                            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

### Part 3: Lesson Card States

**States:**
1. **Completed** ‚Äî Checkmark, full opacity, tap to review
2. **Current** ‚Äî Highlighted border (orange), "Continue" badge, tap to learn
3. **Available** ‚Äî Full opacity, no badge, tap to learn
4. **Locked** ‚Äî Dimmed (40% opacity), lock icon, tap shows "Complete previous lesson"

**Card Design:**
```typescript
interface LessonCardProps {
  rule: GoldenRule;
  status: 'completed' | 'current' | 'available' | 'locked';
  onPress: () => void;
}
```

**Visual Treatment:**
- Completed: `#22c55e` checkmark, subtle green left border
- Current: `#f97316` left border, "CONTINUE ‚Üí" badge
- Available: Default styling, interactive
- Locked: `opacity: 0.4`, `üîí` icon replacing status indicator

---

### Part 4: TapthroughModal Integration

**When user taps a lesson:**
1. Open `TapthroughModal` with 3 slides (one per paragraph)
2. Each slide shows:
   - Lesson title (small, top)
   - Paragraph content (main)
   - Progress dots (bottom)
3. After completing all 3 slides:
   - Show "Lesson Complete" celebration slide
   - Confetti animation (optional, subtle)
   - Haptic success feedback
   - Auto-close after 2 seconds OR tap to dismiss
4. Mark lesson complete in Firestore
5. Unlock next lesson

**Slide Structure:**
```typescript
// Convert GoldenRule to TapthroughSlides
function ruleToSlides(rule: GoldenRule): TapthroughSlide[] {
  return [
    ...rule.paragraphs.map((para, i) => ({
      id: `${rule.id}-${i}`,
      icon: i === 0 ? 'üìñ' : i === 1 ? 'üî¨' : 'üí°',
      title: i === 0 ? rule.title : '', // Only show title on first slide
      subtitle: i === 0 ? rule.subtitle : '',
      body: para,
    })),
    // Completion slide
    {
      id: `${rule.id}-complete`,
      icon: '‚ú®',
      title: 'Lesson Complete',
      body: `You've learned about ${rule.title}. This knowledge will serve you.`,
      isCompletion: true,
    },
  ];
}
```

---

### Part 5: Progress Tracking (Firestore)

**Data Model:**
```typescript
// Firestore: users/{uid}/journey (single document)
interface JourneyDocument {
  completedRules: string[];      // ['golden-001', 'golden-002', ...]
  currentLevel: 'foundation' | 'intermediate' | 'advanced';
  lastCompletedAt: Timestamp | null;
  startedAt: Timestamp;
}
```

**Unlock Logic:**
```typescript
function getLessonStatus(
  ruleId: string, 
  ruleIndex: number, 
  level: string,
  journey: JourneyDocument
): 'completed' | 'current' | 'available' | 'locked' {
  // Completed?
  if (journey.completedRules.includes(ruleId)) return 'completed';
  
  // Is this level unlocked?
  const levelOrder = ['foundation', 'intermediate', 'advanced'];
  const currentLevelIndex = levelOrder.indexOf(journey.currentLevel);
  const ruleLevelIndex = levelOrder.indexOf(level);
  
  if (ruleLevelIndex > currentLevelIndex) return 'locked';
  
  // Within unlocked level: sequential unlock
  const rulesInLevel = getRulesByLevel(level);
  const prevRule = rulesInLevel[ruleIndex - 1];
  
  if (ruleIndex === 0 || journey.completedRules.includes(prevRule.id)) {
    // First in level OR previous completed
    const anyIncomplete = rulesInLevel.some(
      (r, i) => i < ruleIndex && !journey.completedRules.includes(r.id)
    );
    return anyIncomplete ? 'available' : 'current';
  }
  
  return 'locked';
}
```

**Level Unlock Criteria:**
- **Foundation:** Always unlocked
- **Intermediate:** Complete all 8 Foundation lessons
- **Advanced:** Complete all 6 Intermediate lessons

---

### Part 6: Hook Implementation

**Create `hooks/useJourney.ts`:**
```typescript
interface UseJourneyReturn {
  journey: JourneyDocument | null;
  completedCount: number;
  totalCount: number;
  progress: number; // 0-1
  currentLevel: string;
  isLoading: boolean;
  completeLesson: (ruleId: string) => Promise<void>;
  getLessonStatus: (ruleId: string, index: number, level: string) => LessonStatus;
}

export default function useJourney(): UseJourneyReturn {
  // Firestore subscription to journey document
  // Methods to mark lessons complete
  // Derived progress calculations
}
```

---

## üõ† TECHNICAL TASKS

### Navigation (1 hour)
1. Delete `app/(tabs)/log.tsx`
2. Update `app/(tabs)/_layout.tsx`:
   - Remove Log tab
   - Reorder to: Home, Learn, Profile
   - Add custom `LearnTabIcon` with progress ring
3. Install `react-native-svg` if not present (for progress ring)

### Curriculum Screen (3 hours)
4. Rewrite `app/(tabs)/learn.tsx`:
   - Header with large progress arc
   - ScrollView with section headers
   - Lesson cards with status indicators
5. Create `components/curriculum/ProgressArc.tsx`
6. Create `components/curriculum/LessonCard.tsx`
7. Create `components/curriculum/SectionHeader.tsx`

### Data Layer (2 hours)
8. Create `hooks/useJourney.ts`:
   - Firestore subscription
   - `completeLesson()` mutation
   - Progress calculations
9. Initialize journey document on first app load (after onboarding)
10. Update `services/firebase.ts` with journey helpers

### TapthroughModal Extension (1 hour)
11. Extend `TapthroughModal` to support:
    - Title/subtitle on first slide
    - Completion slide variant
    - `onSlideChange` callback for analytics
12. Add confetti animation on lesson completion (optional, use `react-native-confetti-cannon` or CSS)

### Integration (1 hour)
13. Wire up Learn screen to `useJourney` hook
14. Connect lesson taps to TapthroughModal
15. Handle completion flow (mark complete ‚Üí unlock next ‚Üí update UI)

---

## üõ°Ô∏è DESIGN GUIDELINES

### Color Palette (Curriculum)
- **Foundation:** `#22c55e` (green) ‚Äî Growth, basics
- **Intermediate:** `#f97316` (orange) ‚Äî Energy, progress
- **Advanced:** `#8b5cf6` (purple) ‚Äî Mastery, wisdom
- **Locked:** `#a8a29e` at 40% opacity

### Typography
- Section headers: `Manrope_700Bold`, 11px, uppercase, letter-spacing 2
- Lesson titles: `Manrope_600SemiBold`, 16px
- Lesson subtitles: `Manrope_400Regular`, 13px, `#78716c`
- Progress text: `PlayfairDisplay_600SemiBold`, 48px (the percentage)

### Animation
- Progress ring: Animated on mount and on completion
- Lesson cards: FadeInUp stagger on screen load
- Card press: Scale spring (0.98)
- Completion: Haptic success + optional confetti

### Progress Arc Design
- Large arc at top (180¬∞ semicircle or 270¬∞ arc)
- Track: `#e7e5e4`
- Fill: Gradient from `#f97316` to `#22c55e`
- Center: Percentage number + "X of 20" subtitle

---

## üìù CONTENT MAPPING

### Foundation Level (8 lessons)
| # | ID | Title | Subtitle |
|---|-----|-------|----------|
| 1 | golden-001 | Energy Balance | The First Law of Thermodynamics |
| 2 | golden-002 | Protein Leverage | Why Protein Fills You Up |
| 3 | golden-003 | The Thermic Effect | Calories That Cost Calories |
| 4 | golden-004 | Volume Eating | Eat More, Weigh Less |
| 5 | golden-005 | Fiber & Satiety | The Unsung Hero |
| 6 | golden-006 | Water & Hunger | Thirst Disguised |
| 7 | golden-007 | Sleep & Appetite | The Hormonal Reset |
| 8 | golden-008 | Stress & Cortisol | The Weight of Worry |

### Intermediate Level (6 lessons)
| # | ID | Title |
|---|-----|-------|
| 9 | golden-009 | The Whoosh Effect |
| 10 | golden-010 | Hyper-Palatability |
| 11 | golden-011 | Meal Timing Myths |
| 12 | golden-012 | The Plateau |
| 13 | golden-013 | Metabolic Adaptation |
| 14 | golden-014 | Diet Breaks |

### Advanced Level (6 lessons)
| # | ID | Title |
|---|-----|-------|
| 15 | golden-015 | Adaptive Thermogenesis |
| 16 | golden-016 | The Set Point Theory |
| 17 | golden-017 | Refeeds & Leptin |
| 18 | golden-018 | Body Recomposition |
| 19 | golden-019 | Maintenance Psychology |
| 20 | golden-020 | The Long Game |

*(Note: Actual titles/IDs from contentBank.ts ‚Äî verify during implementation)*

---

## üîç TESTING CHECKLIST

### Navigation
- [ ] Only 3 tabs visible: Home, Learn, Profile
- [ ] Learn tab is centered
- [ ] Progress ring shows correct percentage
- [ ] Ring animates on progress change

### Curriculum Screen
- [ ] Progress arc displays correctly
- [ ] All 3 sections visible (Foundation, Intermediate, Advanced)
- [ ] Foundation lessons are interactive
- [ ] Intermediate/Advanced show locked state
- [ ] Lesson cards have correct status indicators

### Lesson Flow
- [ ] Tapping lesson opens TapthroughModal
- [ ] Modal shows 3 paragraphs + completion slide
- [ ] Completion triggers haptic feedback
- [ ] Lesson marked complete in Firestore
- [ ] Next lesson unlocks immediately
- [ ] Progress ring updates

### Edge Cases
- [ ] First-time user sees empty progress (0%)
- [ ] Completing last Foundation lesson unlocks Intermediate
- [ ] Completing all 20 lessons shows "Curriculum Complete" state
- [ ] Tapping completed lesson allows review
- [ ] Tapping locked lesson shows unlock requirement toast

---

## üìä PRIORITY
**High** ‚Äî This is "the other heart of the app" and leverages the TapthroughModal we just built.

## ‚è±Ô∏è ESTIMATED EFFORT
- Navigation restructure: 1 hour
- Curriculum screen UI: 3 hours
- Data layer (useJourney): 2 hours
- TapthroughModal extension: 1 hour
- Integration & polish: 1 hour

**Total: ~8 hours**

---

## üöÄ FUTURE ENHANCEMENTS (Out of Scope)

1. **Daily Lesson Reminders** ‚Äî Push notification: "Today's lesson: The Whoosh Effect"
2. **Lesson Bookmarks** ‚Äî Save favorites for quick reference
3. **Spaced Repetition** ‚Äî Resurface completed lessons periodically
4. **Achievements** ‚Äî "Completed Foundation!" badge
5. **Share Progress** ‚Äî "I'm 50% through the Simplifit curriculum"

