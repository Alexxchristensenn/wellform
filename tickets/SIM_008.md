# SIM-008: Onboarding UI Polish & Philosophy Modal

## üéØ OBJECTIVE
Refine the onboarding flow with UI fixes, add tactile feedback, and transform the ending from "calorie-tracker output" into a proper introduction to Simplifit's philosophy via an elegant tapthrough modal.

## üë§ USER STORY
**As a** new user completing onboarding,
**I want** a polished, tactile experience that ends with clear guidance,
**So that** I understand how Simplifit works and feel confident about what to do first.

---

## ‚úÖ ACCEPTANCE CRITERIA

### Part 1: UI Fixes (Minor Polish)

#### 1.1 EducationScaleView Compaction
**Issue:** "The scale will lie" page requires scrolling on iPhone 13 mini.

**Fix:**
- Reduce `scaleIcon` from 40px to 32px
- Reduce `marginBottom` on `scaleContainer` from 20px to 12px
- Reduce card `padding` from 14px to 12px
- Reduce `insightBox` padding from 14px to 12px and `marginBottom` from 20px to 14px
- Reduce `scrollContent.paddingTop` from 16px to 12px

**Validation:** All content fits on iPhone 13 mini (375√ó812) without scrolling.

#### 1.2 Button Position Consistency (Welcome Slides)
**Issue:** The "Continue/Start" button on WelcomeView slides moves between slides and doesn't align with subsequent screens.

**Current:** Button is inside `slideContent`, positioned by content flow with `marginTop: 16`.
**Fix:** Refactor WelcomeView to use `marginTop: 'auto'` pattern (same as NameView, BioView).

**Validation:** Button position remains fixed across all 3 intro slides.

#### 1.3 Slider Track Width (All Slider Views)
**Issue:** Slider tracks extend nearly full width, creating prominent "line" visuals.

**Affected:** BioView (age), HeightView, WeightView, TargetWeightView

**Fix:** Wrap each slider in a container with `maxWidth: 300` and `alignSelf: 'center'`.

**Validation:** Sliders appear more balanced and focused.

---

### Part 2: Haptic Feedback

**Issue:** No tactile feedback on interactions. Feels "flat."

**Fix:** Add haptic feedback using `expo-haptics`:

```typescript
import * as Haptics from 'expo-haptics';

// On button press (in onPressIn):
Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);

// On slider value change:
Haptics.selectionAsync();

// On successful save/completion:
Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);
```

**Locations:**
- All "Continue" / "Next" button presses
- Slider value changes (throttled to prevent spam)
- Goal card selection
- Activity level selection
- Final "Let's Begin" button (use Success notification)

---

### Part 3: Reusable Tapthrough Modal Component

**Goal:** Create a reusable `<TapthroughModal />` component for educational content that can be used for:
1. Onboarding conclusion (this ticket)
2. Golden Rules in Curriculum (future)
3. Any multi-step educational sequence

#### 3.1 Component Specification

```typescript
interface TapthroughSlide {
  id: string;
  icon: string;           // Emoji or icon name
  title: string;
  body: string;
  accentColor?: string;   // Optional color override
}

interface TapthroughModalProps {
  visible: boolean;
  slides: TapthroughSlide[];
  onComplete: () => void;
  finalButtonText?: string;  // Default: "Got it"
}
```

#### 3.2 Behavior
- Full-screen modal with semi-transparent overlay
- One slide visible at a time
- Tap anywhere (or explicit "Next" button) to advance
- Subtle entrance animation for each slide (fade + slide up)
- Progress dots at bottom showing current position
- Final slide has prominent CTA button
- Haptic feedback on each tap

#### 3.3 Visual Design
- Dark card (`#1c1917`) on light overlay (premium feel)
- Large centered icon (40-48px)
- Title in PlayfairDisplay (24-28px)
- Body in Manrope (14-16px, `#a8a29e`)
- Progress dots: inactive (`#44403c`), active (white)
- Final button: Orange gradient or solid orange (`#f97316`)

---

### Part 4: Onboarding Conclusion (Philosophy Modal)

**Current State:** `BlueprintView` shows TDEE/Calories/Protein, then navigates to home.

**New State:** 
1. `BlueprintView` shows numbers (keep holographic card)
2. User taps "Continue" (not "Start My Journey")
3. `TapthroughModal` opens with 4 slides
4. After final slide, navigate to home

#### 4.1 Philosophy Slides

**Slide 1: "You're Not Counting Forever"**
```
Icon: üß†
Title: "You're Not Counting Forever"
Body: "Simplifit teaches you intuitive eating through biology‚Äînot eternal spreadsheets. After a few weeks, you'll know what 'enough protein' feels like."
```

**Slide 2: "Log Behaviors, Not Macros"**
```
Icon: ‚úì
Title: "Log Behaviors, Not Macros"
Body: "Plate Checks ask simple questions: Protein? Plants? Satisfied? No food databases. No weighing chicken. Just awareness."
```

**Slide 3: "Trust the Trend"**
```
Icon: üìà
Title: "Trust the Trend"
Body: "Your daily weight lies‚Äîwater, salt, and timing cause 2-5 lb swings. We track your 7-day average. That's the truth."
```

**Slide 4: Goal-Specific First Steps**
*(Content varies by goal)*

**Weight Loss:**
```
Icon: üéØ
Title: "Your First Week"
Body: "Focus on protein at every meal. Log your Plate Checks. Weigh yourself a few times. We'll handle the math‚Äîyou just eat."
Accent: #ef4444 (red)
```

**Muscle Gain:**
```
Icon: üí™
Title: "Your First Week"  
Body: "That protein target is non-negotiable. Log Plate Checks after training. The scale will bounce‚Äîfocus on the trend and the mirror."
Accent: #22c55e (green)
```

**Maintenance:**
```
Icon: ‚öñÔ∏è
Title: "Your First Week"
Body: "You've got this. Keep logging to stay mindful. The trend will tell you if anything's drifting. Consistency is the goal."
Accent: #3b82f6 (blue)
```

#### 4.2 Final Button
Text: **"Let's Begin"**
Action: `router.replace('/(tabs)/home')`

---

## üõ† TECHNICAL TASKS

### Part 1 Tasks:
1. **Edit `components/onboarding/EducationScaleView.tsx`:**
   - Reduce padding/margins as specified

2. **Edit `components/onboarding/WelcomeView.tsx`:**
   - Refactor button positioning to use `marginTop: 'auto'` pattern

3. **Edit `components/onboarding/BioView.tsx`, `HeightView.tsx`, `WeightView.tsx`, `TargetWeightView.tsx`:**
   - Add slider wrapper with `maxWidth: 300`

### Part 2 Tasks:
4. **Install expo-haptics** (if not already):
   ```bash
   npx expo install expo-haptics
   ```

5. **Add haptic feedback to all button interactions:**
   - Create utility: `utils/haptics.ts` with throttled functions
   - Apply to AnimatedPressable onPressIn handlers

### Part 3 Tasks:
6. **Create `components/modals/TapthroughModal.tsx`:**
   - Full component with animations
   - Export types for reuse

### Part 4 Tasks:
7. **Edit `components/onboarding/BlueprintView.tsx`:**
   - Add local state: `showPhilosophyModal: boolean`
   - Change button from "Start My Journey" to "Continue"
   - On button press: `setShowPhilosophyModal(true)`
   - Render `<TapthroughModal />` with philosophy slides
   - Move Firebase save + navigation to modal's `onComplete`

---

## üõ°Ô∏è DESIGN GUIDELINES

### Tapthrough Modal Aesthetics:
- **Card:** Dark (`#1c1917`), rounded corners (20px), subtle shadow
- **Icon:** Large (48px), centered, white/colored emoji
- **Title:** PlayfairDisplay 600, 26px, white
- **Body:** Manrope 400, 15px, `#a8a29e`, centered, 22px line height
- **Dots:** 6px circles, 8px gap, inactive `#44403c`, active white
- **Final Button:** Orange (`#f97316`), 50px border radius, uppercase text

### Animation Timing:
- Slide entrance: 300ms ease-out (translateY 30‚Üí0, opacity 0‚Üí1)
- Dot transition: 150ms
- Button scale on press: spring (0.95)

### Haptic Patterns:
- Light impact: Button taps, card selections
- Selection: Slider changes (throttled 100ms)
- Success notification: Final completion only

---

## üìù SAMPLE CODE

### TapthroughModal Structure:
```typescript
// components/modals/TapthroughModal.tsx

export default function TapthroughModal({ 
  visible, 
  slides, 
  onComplete,
  finalButtonText = "Got it"
}: TapthroughModalProps) {
  const [currentIndex, setCurrentIndex] = useState(0);
  const isLastSlide = currentIndex === slides.length - 1;
  
  const handleTap = () => {
    Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);
    
    if (isLastSlide) {
      Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);
      onComplete();
    } else {
      setCurrentIndex(i => i + 1);
    }
  };
  
  // ... render with Modal, Animated.View, etc.
}
```

### Haptics Utility:
```typescript
// utils/haptics.ts
import * as Haptics from 'expo-haptics';

export const hapticLight = () => {
  Haptics.impactAsync(Haptics.ImpactFeedbackStyle.Light);
};

export const hapticSuccess = () => {
  Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);
};

// Throttled for sliders
let lastHaptic = 0;
export const hapticSelection = () => {
  const now = Date.now();
  if (now - lastHaptic > 100) {
    Haptics.selectionAsync();
    lastHaptic = now;
  }
};
```

---

## üîç TESTING CHECKLIST

### Part 1:
- [ ] EducationScaleView fits on iPhone 13 mini without scroll
- [ ] Button position consistent across Welcome slides 0, 1, 2
- [ ] Slider tracks are visually narrower and balanced

### Part 2:
- [ ] Haptic feedback fires on button taps
- [ ] Slider haptics are throttled (not spammy)
- [ ] Success haptic fires on final completion

### Part 3:
- [ ] TapthroughModal opens and closes correctly
- [ ] Tapping advances slides
- [ ] Progress dots update
- [ ] Final button appears on last slide
- [ ] Animation feels smooth

### Part 4:
- [ ] BlueprintView shows "Continue" button
- [ ] Philosophy modal opens with 4 slides
- [ ] Goal-specific slide shows correct content
- [ ] Final "Let's Begin" navigates to home
- [ ] Firebase save completes successfully

---

## üìä PRIORITY
**High** ‚Äî The tapthrough modal pattern will be reused for the Curriculum UI. Building it now establishes the foundation.

## ‚è±Ô∏è ESTIMATED EFFORT
- Part 1 (UI fixes): 1 hour
- Part 2 (Haptics): 30 min
- Part 3 (TapthroughModal): 2 hours
- Part 4 (Integration): 1 hour

**Total: ~4.5 hours**

---

## üìé FUTURE REUSE

The `TapthroughModal` component will be used for:
1. **Golden Rules** in Curriculum - Each rule's 3 paragraphs become 3 slides
2. **Daily Drops** - Quick tips can use 1-2 slides
3. **Achievement celebrations** - "You hit protein 7 days in a row!"
4. **Any educational content** that benefits from focused, paced reading
