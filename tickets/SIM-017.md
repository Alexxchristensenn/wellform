SIM-017: The Insight Engine & Truth Visualization
ðŸŽ¯ OBJECTIVE

Transform Simplifit from a data logger into a data interpreter. We will build the "Weekly Review" system that synthesizes Behavior (Protein/Plants consistency) against Biology (Weight Trend).

Additionally, we will implement a Lightweight Trend Visualization (Sparkline) directly in the insight card, avoiding heavy charting libraries by calculating SVG paths manually (Opus 4.5 can handle this easily).
ðŸ‘¤ USER STORY

As a User, I want to see a weekly summary that shows my consistency alongside my weight trend, So that I understand the correlation between my habits and my results without doing the math myself.
ðŸ”¨ TASKS & IMPLEMENTATION
1. The Brain: hooks/useWeeklyReview.ts

Create a hook that aggregates the last 7 days of data from Firestore.

    Inputs: users/{uid}/days (Behavior) and users/{uid}/weight_logs (Biology).

    Logic:

        Consistency Score: Calculate % of days where protein: true.

        Trend Delta: Compare trendWeight (EMA) of Today vs 7 Days Ago. (Do not use raw scale weight).

        Insight Generator: Return a specific string based on the matrix:

            High Adherence + Trend Down: "Metabolic Gold. Keep going."

            High Adherence + Trend Flat: "Body is adapting. Check sleep/stress."

            Low Adherence + Trend Up: "Biology is honest. Focus on Protein."

    Return Shape:
    TypeScript

    {
      loading: boolean;
      stats: { proteinDays: number; totalDays: number; adherence: number };
      trend: { current: number; delta: number; direction: 'up'|'down'|'flat' };
      history: Array<{ date: string; weight: number | null; trend: number }>; // For the chart
      insight: string;
    }

2. The Face: components/cards/WeeklyInsightCard.tsx

Build a premium, "Holographic" summary card.

    Visuals: Dark glass background, white text.

    The Sparkline (Micro-Chart):

        Use react-native-svg.

        Challenge: Do not install a charting library. Calculate the SVG Path d string manually based on the 7-day trend history.

        Style: A smooth, distinct line (Color: White/Cyan) that represents the EMA Trend.

    The Insight: Display the generated insight string prominently.

3. The Integration: components/home/DailyPulseFeed.tsx

    Inject the WeeklyInsightCard at the top of the feed.

    Logic: For this Alpha stage, always show it (or show it if >= 3 days of logs exist) so we can debug the math.

âœ… ACCEPTANCE CRITERIA

    Math Integrity: The "Trend Delta" matches the difference between the EMA 7 days ago and today.

    Visual Polish:

        The Sparkline renders a smooth line representing the trend.

        The card uses the "Accessible Ethereal" vibe (Glassmorphism/Gradients).

    Performance:

        The hook limits the Firestore query to the last 10-14 days (don't fetch the whole year).

        SVG calculation happens in a useMemo.

    Grandma Test: The text clearly explains the result (e.g., "Down 0.5 lbs") without confusing jargon.

ðŸ›¡ï¸ TECHNICAL GUARDRAILS

    SVG Only: Use react-native-svg for the sparkline. No victory-native or react-native-chart-kit (keep the bundle light).

    Trend > Raw: The sparkline should visualize the Trend (EMA), not the daily raw weight fluctuations (which create anxiety).

    Safety: Handle cases where the user has < 2 data points (show "Gathering Data..." instead of a broken chart).