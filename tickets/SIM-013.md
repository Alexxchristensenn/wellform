# SIM-013: Repo Alignment Cleanup (StyleSheet-Only, Schema Truth, AI ‚ÄúBiology Not Macros‚Äù)

## üéØ OBJECTIVE
Clean up and align the repo so **code, docs, and product philosophy match**. Remove unused styling tooling, reconcile schema documentation with actual Firestore writes/reads, and eliminate any ‚Äúcalorie tracker‚Äù remnants (especially in AI prompts/types).

## üë§ USER STORY
**As a** user,  
**I want** the app to feel consistent and trustworthy,  
**So that** the behaviors + weight trend loop is coherent and doesn‚Äôt accidentally drift back into calorie-counting patterns.

---

## ‚úÖ ACCEPTANCE CRITERIA

### A) Styling: Single Standard (StyleSheet Only)
- NativeWind is **fully removed** (dependency + Metro config + CSS artifacts).
- No documentation references NativeWind/Tailwind.
- App builds and runs normally with **StyleSheet** styling.

### B) Docs & ‚ÄúSource of Truth‚Äù Alignment
- `docs/architecture.md`, `docs/technical.md`, `.cursorrules`, and `README.md` agree on:
  - **Core loop**: Teach ‚Üí Practice ‚Üí Weigh ‚Üí Adjust
  - **No calorie database**
  - **Styling**: StyleSheet
  - **Expo version** guidance matches `package.json` reality
- Firestore schema described in docs matches **actual code paths and shapes**.

### C) Schema Consistency (No Fiction Fields)
- `users/{uid}/days/{YYYY-MM-DD}` schema in docs reflects the current implementation:
  - `meals` keyed by meal type with `{ protein, plants, satiety, timestamp }`
  - optional `weight`, `trend`, optional `behaviors` (workout/sleep), optional `reflection`
- Journey path in docs matches implementation (`users/{uid}/journey/progress`).

### D) AI Service Matches Product Philosophy
- `services/ai.ts` no longer requests/returns calories/macros from photos.
- Photo analysis returns **education-only** JSON: `{ hasProtein, hasVegetables, suggestion }`.
- Chat responses use a **strict JSON schema** (if `json_object` is used, enforce `{ "message": string }`) and persona: **Scientific > Supportive > Witty**.
- All OpenAI calls are wrapped in **try/catch** with graceful failure.

---

## ‚ùå NON-GOALS (Explicitly Out of Scope)
- Building the Weekly Review feature.
- Adding new Firestore collections/fields beyond what already exists.
- Refactoring UI visuals beyond what‚Äôs needed to remove NativeWind drift.
- Re-architecting OpenAI key security (proxy) beyond a brief note in docs (optional).

---

## üõ† TECHNICAL TASKS

### Part 1: Remove NativeWind/Tailwind Completely
- Remove deps: `nativewind`, `tailwindcss` (and any related config deps if present).
- Update `metro.config.js` to stop using `withNativeWind`.
- Delete `global.css` (and any other Tailwind CSS artifacts).
- Confirm no remaining references in repo.

### Part 2: Documentation + Rules Reconciliation
Update these files so they all tell the same story:
- `.cursorrules`
- `README.md`
- `docs/technical.md`
- `docs/architecture.md`

Specifically fix:
- Styling standard contradictions (NativeWind vs StyleSheet).
- Expo SDK version mismatch (docs say 50+, repo is on ~54).
- Journey doc path mismatch (`journey/progress`).
- Timestamp conventions (choose **one** and document it; ideally match code as-is unless changing code too).

### Part 3: Schema Truth Pass (Docs + Types + Comments)
- Ensure `types/schema.ts` comments match real Firestore paths (`journey/progress`, etc.).
- Ensure `docs/architecture.md` section ‚ÄúData Schema‚Äù matches actual `services/firebase.ts`, `hooks/useDailyLog.ts`, `hooks/useWeight.ts`.

### Part 4: AI ‚ÄúNot a Calorie Tracker‚Äù Hardening
- Update `services/ai.ts`:
  - Replace `AIFoodResponse` usage with `AIPlateResponse` (education-only).
  - Update system prompts to forbid calories/macros and focus on ‚ÄúPlate Check‚Äù education.
  - Ensure strict JSON output and robust parsing.
- Grep for any remaining ‚Äúmacro / calories‚Äù UX or data extraction and remove/replace where necessary.

### Part 5: Optional Hygiene (Only If Quick + Clearly Legacy)
- Audit `prototypes/` and any other non-app artifacts:
  - Either remove or move to `adhoc/` with a short README note (keep repo clean).

---

## üîç TESTING CHECKLIST
- [ ] `npm install` succeeds after dep removals
- [ ] `npx expo start` works (iOS + Android)
- [ ] Home + Plate Check flow still works
- [ ] Weight logging/trend still works
- [ ] No runtime errors from missing NativeWind config
- [ ] AI functions return valid JSON and do not mention calories/macros
- [ ] No schema references in docs that contradict `services/firebase.ts` writes

---

## ‚è±Ô∏è ESTIMATED EFFORT
~4‚Äì8 hours depending on how many doc references and legacy remnants exist.

---

## üß† NOTES / RISKS
- If we later want Tailwind-like speed, do it intentionally with a dedicated RFC‚Äîdon‚Äôt keep a half-enabled system that nobody uses.
- OpenAI key in Expo client is a known risk; document it briefly, but don‚Äôt block this cleanup ticket on building a proxy.


